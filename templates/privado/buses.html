{% extends 'privado/base.html' %}

{% block title %}Gestión de Buses{% endblock %}

{% block content %}

<h1>Gestión de Buses</h1>

<!-- MENSAJES FLASH -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
{% endwith %}

<!-- BOTONES SUPERIORES -->
<section>
    <a href="#" class="btn">Nuevo</a>
    <a href="#" class="btn">Editar</a>
    <a href="#" class="btn">Eliminar</a>
</section>

<!-- TABLA LISTADO -->
<section style="margin-top: 15px;">
    <table border="1" width="100%" cellpadding="6">
        <tr>
            <th>Placa</th>
            <th>Modelo</th>
            <th>Marca</th>
            <th>Año</th>
            <th>Última revisión</th>
        </tr>

        {% for b in buses %}
        <tr>
            <td>{{ b.placa }}</td>
            <td>{{ b.modelo }}</td>
            <td>{{ b.marca }}</td>
            <td>{{ b.año }}</td>
            <td>{{ b.revision }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="5" align="center">No hay buses registrados</td>
        </tr>
        {% endfor %}
    </table>
</section>

<!-- FORMULARIO ALTA -->
<section style="margin-top: 20px;">
    <h2>Registrar Nuevo Bus</h2>

    <form method="post">

        <label>Placa</label>
        <input type="text" name="placa" required>

        <label>Modelo</label>
        <select name="id_modelo_bus" required>
            {% for m in modelos %}
                <option value="{{ m.id }}">{{ m.nombre }}</option>
            {% endfor %}
        </select>

        <!-- Nuevo: campo año -->
        <label>Año de fabricación</label>
        <input type="number" name="anio" min="1950" max="2025" required>

        <button type="submit">Guardar</button>
    </form>
</section>

{% endblock %}
